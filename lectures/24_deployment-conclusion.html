

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Lecture 24: Deployment and conclusion &#8212; CPSC 330 Applied Machine Learning 2023W1</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/24_deployment-conclusion';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/UBC-CS-logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/UBC-CS-logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Things you should know</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/README.html">CPSC 330 Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learning-objectives.html">Course Learning Objectives</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lectures</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_intro.html">Lecture 1: Course Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_decision-trees.html">Lecture 2: Terminology, Baselines, Decision Trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_ml-fundamentals.html">Lecture 3: Machine Learning Fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_kNNs-SVM-RBF.html">Lecture 4: <span class="math notranslate nohighlight">\(k\)</span>-Nearest Neighbours and SVM RBFs</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_preprocessing-pipelines.html">Lecture 5: Preprocessing and <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_column-transformer-text-feats.html">Lecture 6: <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> <code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code> and Text Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_linear-models.html">Lecture 7: Linear Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_hyperparameter-optimization.html">Lecture 8: Hyperparameter Optimization and Optimization Bias</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_classification-metrics.html">Lecture 9: Classification metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_regression-metrics.html">Lecture 10: Regression metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_ensembles.html">Lecture 11: Ensembles</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_feat-importances.html">Lecture 12: Feature importances and model transparency</a></li>
<li class="toctree-l1"><a class="reference internal" href="13_feature-engineering-selection.html">Lecture 13: Feature engineering and feature selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_K-Means.html">Lecture 14: K-Means Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="15_DBSCAN-hierarchical.html">Lecture 15: More Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_recommender-systems.html">Lecture 16: Recommender Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="17_natural-language-processing.html">Lecture 17: Introduction to natural language processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_intro_to_computer-vision.html">Lecture 18: Multi-class classification and introduction to computer vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="19_time-series.html">Lecture 19: Time series</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Demos</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="class_demos/03_class-demo.html">Lecture 3: Class demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="class_demos/04_class-demo.html">Lecture 4: Class demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="class_demos/05-06_class-demo.html">Lectures 5 and 6: Class demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="class_demos/07_class-demo.html">Lectures 7: Class demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="class_demos/09_class-demo.html">Exploring classification metrics</a></li>

<li class="toctree-l1"><a class="reference internal" href="class_demos/14_class-demo.html">Lecture 14: Class demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="class_demos/15_class-demo.html">Lecture 15: Class demo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Appendix-A.html">Appendix A</a></li>
<li class="toctree-l1"><a class="reference internal" href="Appendix-B.html">Appendix-B</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Attribution</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../attribution.html">Attributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LICENSE.html">LICENSE</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lectures/24_deployment-conclusion.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lecture 24: Deployment and conclusion</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports-los-announcements">Imports, LOs, Announcements</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning objectives</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#announcements">Announcements</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#final-exam">Final exam</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-deployment-30-min">Model deployment (~30 min)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#try-out-this-moment-predictor">Try out this moment predictor</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-deployment">What is deployment?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#requirements-i-already-did-these">Requirements (I already did these)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demo-deploying-moment-classification-model">Demo: Deploying moment classification model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-a-model">Building a model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#training-on-the-full-corpus">Training on the full corpus</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-the-model">Saving the model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-our-saved-model">Loading our saved model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-setting-up-a-directory-structure-and-environment">(Optional) Setting up a directory structure and environment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-deployment">Model deployment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-and-deploying-a-web-app">Building and deploying a web app</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#web-app-on-local-server">Web app on local server</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#web-app-on-a-real-server">Web app on a real server</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#render-set-up-i-already-did-these">Render set-up (I already did these):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#demo-of-creating-a-new-web-service">Demo of creating a new web service</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#api-on-the-localhost">API on the localhost</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sending-a-request-to-the-api">Sending a request to the API</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deploying-the-api-on-a-server">Deploying the API on a server</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#break-10-min">Break (~10 min)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#course-review-conclusion-20-min">Course review / conclusion (~20 min)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Learning objectives</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-did-we-cover">What did we cover?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#some-key-takeaways">Some key takeaways</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#difference-between-statistics-and-machine-learning">Difference between Statistics and Machine Learning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recipe-to-approach-a-supervised-learning-problem-with-tabular-data">Recipe to approach a supervised learning problem with tabular data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-problem">Understanding the problem</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-analysis-eda-preprocessing">Initial analysis, EDA, preprocessing</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#model-building">Model building</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#model-transparency-and-interpretation">Model transparency and interpretation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-would-i-do-differently">What would I do differently?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-next">What next?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vs-340">330 vs. 340</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-farewell">Conclusion &amp; farewell</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <p><img alt="" src="../_images/330-banner.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="lecture-24-deployment-and-conclusion">
<h1>Lecture 24: Deployment and conclusion<a class="headerlink" href="#lecture-24-deployment-and-conclusion" title="Permalink to this heading">#</a></h1>
<p>UBC 2022-23</p>
<p>Instructor: Varada Kolhatkar</p>
<section id="imports-los-announcements">
<h2>Imports, LOs, Announcements<a class="headerlink" href="#imports-los-announcements" title="Permalink to this heading">#</a></h2>
<section id="imports">
<h3>Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span><span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span><span class="p">,</span> <span class="n">make_pipeline</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="learning-objectives">
<h3>Learning objectives<a class="headerlink" href="#learning-objectives" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Describe the goals and challenges of model deployment.</p></li>
</ul>
</section>
<section id="announcements">
<h3>Announcements<a class="headerlink" href="#announcements" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Last lecture today!</p></li>
<li><p>hw9 is due tomorrow 11:59pm</p></li>
<li><p>Sorry for the delay in getting back the grades for hw7 and hw8. The solutions are available in Canvas.</p></li>
<li><p>No tutorials this week.</p></li>
<li><p>Next Monday the usual morning TA office hours will be there.</p></li>
<li><p>I’ve scheduled extra OH. 2-hour slot in my office (ICCS 237) on Thursday between 11 to 1pm and a 1-hour Zoom slot on Monday between 4 to 5pm.</p></li>
<li><p>I’ll give you some time for formal course evaluations during today’s lecture.</p></li>
</ul>
<section id="final-exam">
<h4>Final exam<a class="headerlink" href="#final-exam" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>Our final exam is on <strong>Dec. 15th at 7pm</strong></p></li>
<li><p>We are split in two rooms: <strong>PHRM 1101 and PHRM 1201</strong>.</p>
<ul>
<li><p>See the schedule <a class="reference external" href="https://students.ubc.ca/enrolment/exams/exam-schedule">here</a></p></li>
</ul>
</li>
<li><p>Where are you supposed to go to write your exam?</p>
<ul>
<li><p>There is alphabetical split.</p></li>
<li><p>ABR-MU: PHRM 1101: Anyone with a family name that begins with M or before would go to PHRM 1101</p></li>
<li><p>NGU-ZHU: PHRM 1201: Anyone with a family name that begins with N or after would go to PHRM 1201</p></li>
</ul>
</li>
<li><p>An update on the internet in our exam rooms: I’ve checked with UBC IT about the internet connection in our exam rooms. We should be fine based on the following response.</p></li>
</ul>
<blockquote>
<div><p>Each of the large lecture theatres in the Pharmacy Building have capacity for 300 simultaneous client devices. The Wireless Access Points serving these rooms are 802.11ax (WIFI 6) capable and were upgraded in Summer 2022.</p>
</div></blockquote>
<ul class="simple">
<li><p>Cummulative</p></li>
<li><p>Open book. You can refer to the notes.</p></li>
<li><p>Please bring your computer and charger. All of it is going to be on Canvas.</p></li>
<li><p>A combination of: Multiple choice questions, short answer questions, simple coding questions</p></li>
<li><p>No communication/collaboration</p></li>
<li><p>No public Piazza posts</p></li>
<li><p>More details are posted on Piazza post &#64;568.</p></li>
</ul>
<p><br><br></p>
</section>
</section>
</section>
<section id="model-deployment-30-min">
<h2>Model deployment (~30 min)<a class="headerlink" href="#model-deployment-30-min" title="Permalink to this heading">#</a></h2>
<section id="try-out-this-moment-predictor">
<h3>Try out this moment predictor<a class="headerlink" href="#try-out-this-moment-predictor" title="Permalink to this heading">#</a></h3>
<p>https://render-test-xygn.onrender.com</p>
<ul class="simple">
<li><p>In this lecture I will show you how to set up/develop this.</p></li>
</ul>
<section id="what-is-deployment">
<h4>What is deployment?<a class="headerlink" href="#what-is-deployment" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>After we train a model, we want to use it!</p></li>
<li><p>The user likely does not want to install your Python stack, train your model.</p></li>
<li><p>You don’t necessarily want to share your dataset.</p></li>
<li><p>So we need to do two things:</p></li>
</ul>
<ol class="arabic simple">
<li><p>Save/store your model for later use.</p></li>
<li><p>Make the saved model conveniently accessible.</p></li>
</ol>
<p>We will use <a class="reference external" href="https://joblib.readthedocs.io/">Joblib</a> for (1) and <a class="reference external" href="https://flask.palletsprojects.com/">Flask</a> &amp; <a class="reference external" href="https://render.com/">render</a> for (2).</p>
</section>
<section id="requirements-i-already-did-these">
<h4>Requirements (I already did these)<a class="headerlink" href="#requirements-i-already-did-these" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>render account. Register <a class="reference external" href="https://render.com/">here</a>.</p></li>
</ul>
<p>More python installations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">Flask</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">Flask</span><span class="o">-</span><span class="n">WTF</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">joblib</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="demo-deploying-moment-classification-model">
<h2>Demo: Deploying moment classification model<a class="headerlink" href="#demo-deploying-moment-classification-model" title="Permalink to this heading">#</a></h2>
<section id="building-a-model">
<h3>Building a model<a class="headerlink" href="#building-a-model" title="Permalink to this heading">#</a></h3>
<p>Recall the multi-class classification problem using the <a class="reference external" href="https://www.kaggle.com/ritresearch/happydb">HappyDB</a> corpus.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/cleaned_hm.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sample_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">sample_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">sample_df</span> <span class="o">=</span> <span class="n">sample_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;cleaned_hm&quot;</span><span class="p">:</span> <span class="s2">&quot;moment&quot;</span><span class="p">,</span> <span class="s2">&quot;ground_truth_category&quot;</span><span class="p">:</span> <span class="s2">&quot;target&quot;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">sample_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/cleaned_hm.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">sample_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">sample_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="nn">File ~/miniconda3/envs/jbook/lib/python3.10/site-packages/pandas/util/_decorators.py:311,</span> in <span class="ni">deprecate_nonkeyword_arguments.&lt;locals&gt;.decorate.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">305</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">num_allow_args</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">306</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">307</span>         <span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arguments</span><span class="o">=</span><span class="n">arguments</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">308</span>         <span class="ne">FutureWarning</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span>         <span class="n">stacklevel</span><span class="o">=</span><span class="n">stacklevel</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">310</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">311</span> <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/jbook/lib/python3.10/site-packages/pandas/io/parsers/readers.py:680,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, squeeze, prefix, mangle_dupe_cols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, error_bad_lines, warn_bad_lines, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">665</span> <span class="n">kwds_defaults</span> <span class="o">=</span> <span class="n">_refine_defaults_read</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">666</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">667</span>     <span class="n">delimiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">676</span>     <span class="n">defaults</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;delimiter&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="p">},</span>
<span class="g g-Whitespace">    </span><span class="mi">677</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">678</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">680</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/jbook/lib/python3.10/site-packages/pandas/io/parsers/readers.py:575,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">572</span> <span class="n">_validate_names</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">574</span> <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">575</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">577</span> <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">578</span>     <span class="k">return</span> <span class="n">parser</span>

<span class="nn">File ~/miniconda3/envs/jbook/lib/python3.10/site-packages/pandas/io/parsers/readers.py:933,</span> in <span class="ni">TextFileReader.__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">930</span>     <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">932</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">--&gt; </span><span class="mi">933</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/jbook/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1217,</span> in <span class="ni">TextFileReader._make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1213</span>     <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;rb&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1214</span> <span class="c1"># error: No overload variant of &quot;get_handle&quot; matches argument types</span>
<span class="g g-Whitespace">   </span><span class="mi">1215</span> <span class="c1"># &quot;Union[str, PathLike[str], ReadCsvBuffer[bytes], ReadCsvBuffer[str]]&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1216</span> <span class="c1"># , &quot;str&quot;, &quot;bool&quot;, &quot;Any&quot;, &quot;Any&quot;, &quot;Any&quot;, &quot;Any&quot;, &quot;Any&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1217</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">(</span>  <span class="c1"># type: ignore[call-overload]</span>
<span class="g g-Whitespace">   </span><span class="mi">1218</span>     <span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1219</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1220</span>     <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1221</span>     <span class="n">compression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1222</span>     <span class="n">memory_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1223</span>     <span class="n">is_text</span><span class="o">=</span><span class="n">is_text</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1224</span>     <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding_errors&quot;</span><span class="p">,</span> <span class="s2">&quot;strict&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1225</span>     <span class="n">storage_options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1226</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1227</span> <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1228</span> <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="o">.</span><span class="n">handle</span>

<span class="nn">File ~/miniconda3/envs/jbook/lib/python3.10/site-packages/pandas/io/common.py:789,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">784</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">785</span>     <span class="c1"># Check whether the filename is to be opened in binary mode.</span>
<span class="g g-Whitespace">    </span><span class="mi">786</span>     <span class="c1"># Binary mode does not support &#39;encoding&#39; and &#39;newline&#39;.</span>
<span class="g g-Whitespace">    </span><span class="mi">787</span>     <span class="k">if</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">and</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">788</span>         <span class="c1"># Encoding</span>
<span class="ne">--&gt; </span><span class="mi">789</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">790</span>             <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">791</span>             <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">792</span>             <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">793</span>             <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">794</span>             <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">795</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">796</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">797</span>         <span class="c1"># Binary mode</span>
<span class="g g-Whitespace">    </span><span class="mi">798</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;data/cleaned_hm.csv&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_df</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>affection           4810
achievement         4276
bonding             1750
enjoy_the_moment    1514
leisure             1306
nature               252
exercise             217
Name: target, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>It’s a multiclass classification problem!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span><span class="p">,</span> <span class="n">test_df</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">sample_df</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">X_train_happy</span><span class="p">,</span> <span class="n">y_train_happy</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="s2">&quot;moment&quot;</span><span class="p">],</span> <span class="n">train_df</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>
<span class="n">X_test_happy</span><span class="p">,</span> <span class="n">y_test_happy</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="s2">&quot;moment&quot;</span><span class="p">],</span> <span class="n">test_df</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_lr</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
    <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">stop_words</span><span class="o">=</span><span class="s2">&quot;english&quot;</span><span class="p">),</span>
    <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">2000</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_happy</span><span class="p">,</span> <span class="n">y_train_happy</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_lr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_happy</span><span class="p">,</span> <span class="n">y_train_happy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9528318584070796
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_lr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_happy</span><span class="p">,</span> <span class="n">y_test_happy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8169911504424778
</pre></div>
</div>
</div>
</div>
</section>
<section id="training-on-the-full-corpus">
<h3>Training on the full corpus<a class="headerlink" href="#training-on-the-full-corpus" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Ideally, you’ll try all different models, fine tune the most promising models and deploy the best performing model.</p></li>
<li><p>Sometimes before deploying a model people train it on the full dataset.</p>
<ul>
<li><p>This is probably a good idea, because more data is better.</p></li>
<li><p>It’s also a little scary, because we can’t test this new model.</p></li>
</ul>
</li>
<li><p>Here I’m just deploying the model trained on the training set.</p></li>
</ul>
</section>
<section id="saving-the-model">
<h3>Saving the model<a class="headerlink" href="#saving-the-model" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>If we want to deploy a model, we need to save it.</p></li>
<li><p>we are using <code class="docutils literal notranslate"><span class="pre">joblib</span></code> for that.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">joblib</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;web_api/moment_predictor.joblib&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">pipe_lr</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;web_application/moment_predictor.joblib&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">pipe_lr</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll define a function that accepts input data as a dictionary and returns a prediction:</p>
</section>
<section id="loading-our-saved-model">
<h3>Loading our saved model<a class="headerlink" href="#loading-our-saved-model" title="Permalink to this heading">#</a></h3>
<p>Let’s write a function to get predictions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">return_prediction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">text</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">prediction</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;web_api/moment_predictor.joblib&quot;</span><span class="p">)</span> <span class="c1"># load the saved model</span>
<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;I love my students!&quot;</span>
<span class="n">return_prediction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;affection&#39;
</pre></div>
</div>
</div>
</div>
<p>This function appears in the <code class="docutils literal notranslate"><span class="pre">app.py</span></code> that we’ll be using shortly.</p>
</section>
<section id="optional-setting-up-a-directory-structure-and-environment">
<h3>(Optional) Setting up a directory structure and environment<a class="headerlink" href="#optional-setting-up-a-directory-structure-and-environment" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>We need a specific directory structure to help us easily deploy our machine learning model.</p></li>
<li><p>This is already set up in this repo.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├── web_api
│   └── moment_predictor.joblib  # this is the machine learning model we have built locally
│   └── app.py  # the file that defines our flask API
│   └── Procfile  # required to help start flask app
│   └── requirements.txt  # file containing required packages
│   
└── web_application
    └── moment_predictor.joblib  # this is the machine learning model we have built locally
    └── app.py  # the file that defines our flask API
    └── Procfile  # required to help start flask app
    └── requirements.txt  # file containing required packages
    └── templates  # contains HTML templates to help us build the web application
    │   └── style.css  # css template to be used in web application
    └── static  # this subdirectory contains CSS style sheets
        └── home.html  # html template to be used in web application
        └── prediction.html  # html template to be used in web application
</pre></div>
</div>
</section>
<section id="model-deployment">
<h3>Model deployment<a class="headerlink" href="#model-deployment" title="Permalink to this heading">#</a></h3>
<p>We have two options for deploying our moment prediction model. We can:</p>
<ol class="arabic simple">
<li><p>Build a web application (app) with a HTML user-interface that interacts directly with our model.</p></li>
<li><p>Develop a RESTful (REST stands for REpresentational State Transfer) web API that accepts HTTP requests in the form of input data and returns a prediction.</p></li>
</ol>
<p>We’ll explore both options below.</p>
</section>
<section id="building-and-deploying-a-web-app">
<h3>Building and deploying a web app<a class="headerlink" href="#building-and-deploying-a-web-app" title="Permalink to this heading">#</a></h3>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>on localhost (my laptop)</p></th>
<th class="head"><p>on server (the interwebs)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>app</p></td>
<td><p>❓</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>API</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Flask can create entire web applications.</p></li>
<li><p>We need to link our code to some html and css to create our web application.</p></li>
<li><p>We will use Flask to create a html form, accept data submitted to the form, and return a prediction using the submitted data.</p></li>
<li><p>Again, I won’t go into too much detail here, but we can open up <code class="docutils literal notranslate"><span class="pre">web_application/</span></code> and take a quick look.</p></li>
</ul>
<ul class="simple">
<li><p>If you want to learn more about Flask, see:</p>
<ul>
<li><p><a class="reference external" href="https://www.youtube.com/playlist?list=PL-osiE80TeTs4UjLw5MM6OjgkjFeUxCYH">Flask tutorial video series by Corey Schafer</a></p></li>
<li><p><a class="reference external" href="https://flask.palletsprojects.com/en/1.1.x/">Flask docs</a></p></li>
<li><p><a class="reference external" href="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world">Flask tutorial by Miguel Grinberg</a></p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>Let’s try <code class="docutils literal notranslate"><span class="pre">web_application/app.py</span></code> that handles this part.</p></li>
<li><p>We can open it up here in Jupyter and take a look.</p></li>
<li><p>If we run <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">app.py</span></code> we’ll bring it to life.</p></li>
</ul>
</section>
<section id="web-app-on-local-server">
<h3>Web app on local server<a class="headerlink" href="#web-app-on-local-server" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Go to the terminal.</p></li>
<li><p>Navigate to the <code class="docutils literal notranslate"><span class="pre">web_application</span></code> directory.</p></li>
<li><p>Run the following to make the app alive: <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">app.py</span></code>.</p>
<ul class="simple">
<li><p>If you get an error, you may need to install those extra packages and make sure you have the environment loaded.</p></li>
</ul>
</li>
<li><p>Now you should be able to access the app at: <code class="docutils literal notranslate"><span class="pre">http://127.0.0.1:5000/</span></code> or <code class="docutils literal notranslate"><span class="pre">http://localhost:5000/</span></code>.</p></li>
</ol>
</section>
<section id="web-app-on-a-real-server">
<h3>Web app on a real server<a class="headerlink" href="#web-app-on-a-real-server" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>If you want people to use your app/model, you would probably want to put it on a real server and not your laptop so that it’s live all the time.</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>on localhost (my laptop)</p></th>
<th class="head"><p>on server (the interwebs)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>app</p></td>
<td><p>✅</p></td>
<td><p>❓</p></td>
</tr>
<tr class="row-odd"><td><p>API</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>We’ll use <a class="reference external" href="https://render.com/">Render</a> for this.</p></li>
</ul>
</section>
<section id="render-set-up-i-already-did-these">
<h3>Render set-up (I already did these):<a class="headerlink" href="#render-set-up-i-already-did-these" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Go to <a class="reference external" href="https://dashboard.render.com/">render</a>, log-in</p></li>
<li><p>Click on “New” and create a web service.</p></li>
</ol>
<p><img alt="" src="../_images/render-new-app.png" /></p>
<!-- <img src="img/render-new-app.png" width="600"> --></section>
<section id="demo-of-creating-a-new-web-service">
<h3>Demo of creating a new web service<a class="headerlink" href="#demo-of-creating-a-new-web-service" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Create an associated GitHub repository.</p></li>
<li><p>I’ve put the contents from <code class="docutils literal notranslate"><span class="pre">web_application</span></code> folder <a class="reference external" href="https://github.com/kvarada/ml-deployment-example">in this repository</a>.</p></li>
<li><p>Then you connect that repository to your new web service in render.</p></li>
</ul>
<p><img alt="" src="../_images/github-to-render.png" /></p>
<ul class="simple">
<li><p>Once you fill in all the information, it’ll create an environment for you using <code class="docutils literal notranslate"><span class="pre">requirement.txt</span></code> and if everything goes well, your web service will be live.</p></li>
<li><p>You’ll see a link at the top which you can share with your friends.</p></li>
</ul>
<ul class="simple">
<li><p>Try it out for your own machine learning applications!</p></li>
<li><p>This is nice! If you develop a model and you want your friends to try it out without installing anything on their local computers, you can do this.</p></li>
</ul>
</section>
<section id="api-on-the-localhost">
<h3>API on the localhost<a class="headerlink" href="#api-on-the-localhost" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Often you want other people to be able to use your models in their applications.</p></li>
<li><p>We can do this by creating an <strong>API</strong>.</p></li>
<li><p>If you don’t know what an API is, that’s OK.</p>
<ul>
<li><p>For our purposes, it’s something that exists at a particular address, that can accept information and return information.</p></li>
<li><p>Sort of like a function but not Python-specific and potentially accessible by anyone on the internet.</p></li>
</ul>
</li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>on localhost (my laptop)</p></th>
<th class="head"><p>on server (the interwebs)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>app</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-odd"><td><p>API</p></td>
<td><p>❓</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Go to the terminal.</p></li>
<li><p>Navigate to <code class="docutils literal notranslate"><span class="pre">web_api</span></code> folder in this repo.</p></li>
<li><p>Run the following to make the api alive: <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">app.py</span></code></p></li>
</ul>
<p>(Note that for more complex applications, you may choose to containerize everything in a Docker container to deploy to render).</p>
</section>
<section id="sending-a-request-to-the-api">
<h3>Sending a request to the API<a class="headerlink" href="#sending-a-request-to-the-api" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>We have a RESTful (REST stands for REpresentational State Transfer) web API that accepts HTTP requests in the form of input data and returns a prediction.</p></li>
<li><p>Now you can send requests to the API and get predictions.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>!curl -d &#39;{&quot;text&quot;:&quot;The students will be submitting their last homework assignment today!&quot;}&#39; \
      -H &quot;Content-Type: application/json&quot; \
      -X POST http://localhost:5000/predict
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">curl</span></code> (stands for client URL) is a tool for transferring data using various network protocols.</p></li>
<li><p>Okay, so we have a working API running on localhost, but we don’t want to host this service on my laptop!</p></li>
</ul>
</section>
<section id="deploying-the-api-on-a-server">
<h3>Deploying the API on a server<a class="headerlink" href="#deploying-the-api-on-a-server" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>We now want to deploy it on a “real” server so others can send it requests.</p></li>
<li><p>We will use render to deploy our app but you could also use other services such as AWS.</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>on localhost (my laptop)</p></th>
<th class="head"><p>on server (the interwebs)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>app</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-odd"><td><p>API</p></td>
<td><p>✅</p></td>
<td><p>❓</p></td>
</tr>
</tbody>
</table>
<p>Follow the instructions <a class="reference external" href="https://render.com/docs/api">here</a> to try the API on server.</p>
</section>
<section id="discussion">
<h3>Discussion<a class="headerlink" href="#discussion" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>There are many ways to deploy a model; a RESTful API is very common and convenient.</p></li>
<li><p>As you can see, a simple deployment is fairly straightward.</p></li>
<li><p>However, there may be other considerations such as:</p>
<ul>
<li><p>Privacy/security</p></li>
<li><p>Scaling to large number of requests</p></li>
<li><p>Error handling</p></li>
<li><p>Real-time / speed</p></li>
<li><p>Low-resource environments (e.g. edge computing)</p></li>
<li><p>etc.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="break-10-min">
<h2>Break (~10 min)<a class="headerlink" href="#break-10-min" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>We’ll take a longer break today.</p></li>
<li><p>Consider taking this time to fill out the instructor/TA evaluations if you haven’t already.</p>
<ul>
<li><p>Evaluation link: https://canvas.ubc.ca/courses/101888/external_tools/4732</p></li>
</ul>
</li>
</ul>
<p><img alt="" src="../_images/eva-coffee.png" /></p>
<ul class="simple">
<li><p>Here is <a class="reference external" href="https://www.reddit.com/r/UBC/comments/k18qj7/teaching_evaluations_the_good_the_bad_and_the_ugly/">Mike’s post on these evaluations</a></p></li>
</ul>
</section>
<section id="course-review-conclusion-20-min">
<h2>Course review / conclusion (~20 min)<a class="headerlink" href="#course-review-conclusion-20-min" title="Permalink to this heading">#</a></h2>
<p><img alt="" src="../_images/ml-workflow.png" /></p>
<section id="id1">
<h3>Learning objectives<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>Here are the course learning outcomes:</p>
<ol class="arabic simple">
<li><p>Identify problems that may be addressed with machine learning.</p></li>
<li><p>Select the appropriate machine learning tool for a problem.</p></li>
<li><p>Transform data of various types into usable features.</p></li>
<li><p>Apply standard tools implementing supervised and unsupervised learning techniques.</p></li>
<li><p>Describe core differences between training, validation, and testing regimes.</p></li>
<li><p>Effectively communicate the results of a machine learning pipeline.</p></li>
<li><p>Be realistic about the limitations of individual approaches and machine learning as a whole.</p></li>
<li><p>Identify and avoid scenarios in which training and testing data are accidentally mixed (the “Golden Rule”).</p></li>
<li><p>Employ good habits for applying ML, such as starting an analysis with a baseline estimator.</p></li>
<li><p>Create reproducible workflows and pipelines.</p></li>
</ol>
<ul class="simple">
<li><p>How did we do?</p></li>
<li><p>Hopefully OK, except we skipped the last point.</p></li>
<li><p>There is a <a class="reference external" href="https://ubc-dsci.github.io/dsci-310-student/">new course</a> on this topic.</p></li>
</ul>
</section>
<section id="what-did-we-cover">
<h3>What did we cover?<a class="headerlink" href="#what-did-we-cover" title="Permalink to this heading">#</a></h3>
<p>I see the course roughly like this (not in order):</p>
<p>Part 1: Supervised learning on tabular data</p>
<ul class="simple">
<li><p>Overfitting, train/validation/test/deployment, cross-validation</p></li>
<li><p>Feature preprocessing, pipelines, imputation, OHE, etc</p></li>
<li><p>The Golden Rule, various ways to accidentally violate it</p></li>
<li><p>Classification metrics: confusion matrix, precision/recall, ROC, AUC</p></li>
<li><p>Regression metrics: MSE, MAPE</p></li>
<li><p>Feature importances, feature selection</p></li>
<li><p>Hyperparameter optimization</p></li>
</ul>
<ul class="simple">
<li><p>A bunch of models:</p>
<ul>
<li><p>baselines</p></li>
<li><p>linear models (ridge, logistic regression)</p></li>
<li><p>KNNs and RBF SVMs</p></li>
<li><p>tree-based models (random forest, gradient boosted trees)</p></li>
<li><p>Ensembles</p></li>
</ul>
</li>
</ul>
<p>Part 2: Other data types (non-tabular)</p>
<ul class="simple">
<li><p>Clustering: K-Means, DBSCAN</p></li>
<li><p>Recommender systems</p></li>
<li><p>Computer vision with pre-trained deep learning models (high level)</p></li>
<li><p>Language data, text preprocessing, embeddings, topic modeling</p></li>
<li><p>Time series</p></li>
<li><p>Right-censored data / survival analysis</p></li>
</ul>
<p>Part 3: Communication and Ethics</p>
<ul class="simple">
<li><p>Ethics for ML</p></li>
<li><p>Communicating your results</p></li>
<li><p>ML skepticism</p></li>
</ul>
</section>
<section id="some-key-takeaways">
<h3>Some key takeaways<a class="headerlink" href="#some-key-takeaways" title="Permalink to this heading">#</a></h3>
<p>Some useful guidelines:</p>
<ul class="simple">
<li><p>Do train-test split right away and only once</p></li>
<li><p>Don’t look at the test set until the end</p></li>
<li><p>Don’t call <code class="docutils literal notranslate"><span class="pre">fit</span></code> on test/validation data</p></li>
<li><p>Use pipelines</p></li>
<li><p>Use baselines</p></li>
<li><p>Do not be overconfident about your results</p></li>
</ul>
</section>
<section id="difference-between-statistics-and-machine-learning">
<h3>Difference between Statistics and Machine Learning<a class="headerlink" href="#difference-between-statistics-and-machine-learning" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>There is no clear boundary.</p></li>
<li><p>But loosely</p>
<ul>
<li><p>in statistics the emphasis is on inference (usually framed as hypothesis testing)</p></li>
<li><p>in machine learning the emphasis is on prediction and generalization. We are primarily interested in using our model on new unseen examples.</p></li>
</ul>
</li>
</ul>
</section>
<section id="recipe-to-approach-a-supervised-learning-problem-with-tabular-data">
<h3>Recipe to approach a supervised learning problem with tabular data<a class="headerlink" href="#recipe-to-approach-a-supervised-learning-problem-with-tabular-data" title="Permalink to this heading">#</a></h3>
<section id="understanding-the-problem">
<h4>Understanding the problem<a class="headerlink" href="#understanding-the-problem" title="Permalink to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Have a long conversation with the stakeholder(s) who will be using your pipeline.</p></li>
<li><p>Have a long conversation with the person(s) who collected the data.</p></li>
<li><p>Think about</p>
<ul class="simple">
<li><p>what do you want to accomplish?</p></li>
<li><p>whether you really need to use machine learning for the problem or not</p></li>
<li><p>how do you want to frame the problem as a supervised machine learning problem? What do you want to predict?</p></li>
<li><p>how do you plan to measure your success?</p></li>
<li><p>is there a baseline?</p></li>
<li><p>is there any operating point?</p></li>
<li><p>what will it buy the stakeholders if you improve over their current baseline?</p></li>
</ul>
</li>
<li><p>Think about the ethical implications - are you sure you want to do this project? If so, should ethics guide your approach?</p></li>
</ol>
</section>
<section id="initial-analysis-eda-preprocessing">
<h4>Initial analysis, EDA, preprocessing<a class="headerlink" href="#initial-analysis-eda-preprocessing" title="Permalink to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Random train-test split with fixed random seed; do not touch the test data until Step 16.</p></li>
<li><p>Exploratory data analysis, outlier detection.</p></li>
<li><p>Choose a scoring metric -&gt; higher values should make you &amp; your stakeholders happier.</p></li>
<li><p>Feature engineering –&gt; Create new features which might be useful to solve the prediction problem. This is typically a time-consuming process. Also, sometimes you get an idea of good features only after looking at your model results. So it’s an iterative process.</p></li>
<li><p>Fit a baseline model, e.g. <code class="docutils literal notranslate"><span class="pre">DummyClassifier</span></code> or <code class="docutils literal notranslate"><span class="pre">DummyRegressor</span></code>.</p></li>
<li><p>Create a preprocessing pipeline.</p></li>
<li><p>(Optional) Incorporate feature selection.</p></li>
</ol>
</section>
<section id="model-building">
<h4>Model building<a class="headerlink" href="#model-building" title="Permalink to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Try a linear model, e.g. <code class="docutils literal notranslate"><span class="pre">LogisticRegression</span></code> for classification or <code class="docutils literal notranslate"><span class="pre">Ridge</span></code>; tune hyperparameters with CV.</p></li>
<li><p>Try other sensible model(s), e.g. LightGBM; tune hyperparameters with CV.</p></li>
<li><p>For each model, look at sub-scores from the folds of cross-validation to get a sense of “error bars” on the scores.</p></li>
<li><p>Pick a few reasonable models. Best CV score is a reasonable metric, though you may choose to favour simpler models.</p></li>
<li><p>Carry out hyperparameter optimization for these models, paying attention to whether you are not susceptible to optimization bias.</p></li>
<li><p>Try averaging and stacking to examine whether you improve the results over  your best-performing models.</p></li>
</ol>
</section>
<section id="model-transparency-and-interpretation">
<h4>Model transparency and interpretation<a class="headerlink" href="#model-transparency-and-interpretation" title="Permalink to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Look at feature importances.</p></li>
<li><p>(optional) Perform some more diagnostics like confusion matrix for classification, or “predicted vs. true” scatterplots for regression.</p></li>
<li><p>(optional) Try to calibrate the uncertainty/confidence outputted by your model.</p></li>
<li><p>Test set evaluation.</p></li>
<li><p>Model transparency. Take a random sample from the test data and try to explain your predictions using SHAP plots.</p></li>
<li><p>Question everything again: validity of results, bias/fairness of trained model, etc.</p></li>
<li><p>Concisely summarize your results and discuss them with stakeholders.</p></li>
<li><p>(optional) Retrain on all your data.</p></li>
<li><p>Deployment &amp; integration.</p></li>
</ol>
<p>PS: the order of steps is approximate, and some steps may need to be repeated during prototyping, experimentation, and as needed over time.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The order of steps is approximate, and some steps may need to be repeated during prototyping, experimentation, and as needed over time.</p>
</div>
<p><br><br></p>
</section>
</section>
<section id="what-would-i-do-differently">
<h3>What would I do differently?<a class="headerlink" href="#what-would-i-do-differently" title="Permalink to this heading">#</a></h3>
<p>Lots of room for improvement. Here are some things on my mind.</p>
<ul class="simple">
<li><p>Flipped classroom in a more effective way in the first part of the course.</p></li>
<li><p>More demos during the lecture time</p></li>
<li><p>Worksheets/Practice questions during tutorials</p></li>
<li><p>Moving some weight from final exam to a course project</p></li>
<li><p>Add more interactive components in the lectures</p></li>
<li><p>Some material to cover: dealing with outliers, data collection</p></li>
</ul>
<p>I’m sure you have other suggestions - feel free to drop me an email or drop them in the course evaluations.</p>
</section>
<section id="what-next">
<h3>What next?<a class="headerlink" href="#what-next" title="Permalink to this heading">#</a></h3>
<p>If you want to further develop your machine learning skills:</p>
<ul class="simple">
<li><p>Practice!</p>
<ul>
<li><p>Work on your own projects</p></li>
</ul>
</li>
<li><p>Work hard and be consistent.</p></li>
<li><p>If you are interested in research in machine learning</p>
<ul>
<li><p>Take CPSC 340. If you do not have the required prereqs you can try to audit it.</p></li>
<li><p>Get into the habit of reading papers and replicating results</p></li>
</ul>
</li>
</ul>
</section>
<section id="vs-340">
<h3>330 vs. 340<a class="headerlink" href="#vs-340" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>We are hoping lots of people will take both courses.</p></li>
<li><p>There is some overlap but not a crazy amount.</p></li>
<li><p>If you want to learn how these methods work under the hood, CPSC 340 will give you a lot of that, such as:</p>
<ul>
<li><p>Implementing <code class="docutils literal notranslate"><span class="pre">Ridge.fit()</span></code> from scratch</p></li>
<li><p>Mathematically speaking, what is <code class="docutils literal notranslate"><span class="pre">C</span></code> in <code class="docutils literal notranslate"><span class="pre">LogisticRegression</span></code>?</p></li>
<li><p>How fast do these algorithms run in terms of the number of rows and columns of your dataset?</p></li>
<li><p>Etc.</p></li>
</ul>
</li>
<li><p>There are also a bunch of other methods covered.</p></li>
</ul>
</section>
</section>
<section id="conclusion-farewell">
<h2>Conclusion &amp; farewell<a class="headerlink" href="#conclusion-farewell" title="Permalink to this heading">#</a></h2>
<p>That’s all, folks. We made it! Good luck on your final exam! When you get a chance, please let me know what worked for you and what didn’t work for you in this course.</p>
<p><img alt="" src="../_images/eva-congrats.png" /></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "conda-env-cpsc330-py"
        },
        kernelOptions: {
            name: "conda-env-cpsc330-py",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'conda-env-cpsc330-py'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports-los-announcements">Imports, LOs, Announcements</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning objectives</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#announcements">Announcements</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#final-exam">Final exam</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-deployment-30-min">Model deployment (~30 min)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#try-out-this-moment-predictor">Try out this moment predictor</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-deployment">What is deployment?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#requirements-i-already-did-these">Requirements (I already did these)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demo-deploying-moment-classification-model">Demo: Deploying moment classification model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-a-model">Building a model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#training-on-the-full-corpus">Training on the full corpus</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-the-model">Saving the model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-our-saved-model">Loading our saved model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-setting-up-a-directory-structure-and-environment">(Optional) Setting up a directory structure and environment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-deployment">Model deployment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-and-deploying-a-web-app">Building and deploying a web app</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#web-app-on-local-server">Web app on local server</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#web-app-on-a-real-server">Web app on a real server</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#render-set-up-i-already-did-these">Render set-up (I already did these):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#demo-of-creating-a-new-web-service">Demo of creating a new web service</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#api-on-the-localhost">API on the localhost</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sending-a-request-to-the-api">Sending a request to the API</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deploying-the-api-on-a-server">Deploying the API on a server</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#break-10-min">Break (~10 min)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#course-review-conclusion-20-min">Course review / conclusion (~20 min)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Learning objectives</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-did-we-cover">What did we cover?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#some-key-takeaways">Some key takeaways</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#difference-between-statistics-and-machine-learning">Difference between Statistics and Machine Learning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recipe-to-approach-a-supervised-learning-problem-with-tabular-data">Recipe to approach a supervised learning problem with tabular data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-problem">Understanding the problem</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-analysis-eda-preprocessing">Initial analysis, EDA, preprocessing</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#model-building">Model building</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#model-transparency-and-interpretation">Model transparency and interpretation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-would-i-do-differently">What would I do differently?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-next">What next?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vs-340">330 vs. 340</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-farewell">Conclusion &amp; farewell</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Varada Kolhatkar
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>